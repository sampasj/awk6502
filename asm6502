BEGIN {
    srcfile = ARGV[1]
    ARGV[1] = ""  # remaining files are data
    tempfile = "asm6502.temp"
    setopcodetbl()
    assemblerpass1()
    assemblerpass2()
    interpreter()
}

function setopcodetbl() {
    op["NOP"] = 234    # 0xEA
}

function assemblerpass1() {
    # ASSEMBLER PASS 1
    FS = "[ \t]+"   # multiple spaces and/or tabs as separator
    while (getline <srcfile > 0) {
        sub(/#.*/, "")         # strip comments
        symtab[$1] = nextmem   # remember label location
        if ($2 != "") {        # save op, addr if present
           print $2 "\t" $3 >tempfile
           nextmem++
        }
    }
    close(tempfile)
}

function assemblerpass2() {
    
}

function interpreter() {
    
}